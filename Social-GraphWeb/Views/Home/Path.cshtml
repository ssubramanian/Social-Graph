@model Social_GraphWeb.Controllers.PathViewModel

@{
	ViewBag.Title = "The path between " + Model.Me.Data.FirstName + " and " + Model.Target.Data.FirstName;
	Layout = "../Shared/_Layout.cshtml";
}

<div>
	<p class="path-title">There are <label class="highlight-digit">@Model.CountOfHops</label> people between @Model.Me.Data.FirstName and @Model.Target.Data.FirstName:</p> 
	<ol>
	@{
		var count = 0;
		foreach (var relationship in Model.ShortestPath.Relationships)
		{
			var startNode = Model.ShortestPath.Nodes.First(n => n.Reference == relationship.StartNodeReference);
			var endNode = Model.ShortestPath.Nodes.First(n => n.Reference == relationship.EndNodeReference);

			var startName = startNode.Data.FirstName;
			var endName = endNode.Data.FirstName;

			var relationshipTypeKey = @relationship.TypeKey.Replace("_", " ");
					
			count++;
			<li data-start-id="@startNode.Reference.Id" data-end-id="@endNode.Reference.Id" data-relationship-id="@relationship.Reference.Id">
				@startName <label class="relationship">@relationshipTypeKey</label> @endName
			</li>
		}
	}
	</ol>
			
	<br></br>
	
	@if (Model.OtherPaths.Any())
	{
	<p class="path-title">There are <label class="highlight-digit">@Model.OtherPaths.Count()</label> other paths between @Model.Me.Data.FirstName and @Model.Target.Data.FirstName:</p> 
	<div>
		@foreach (var path in Model.OtherPaths)
		{
			<ol>
				@foreach (var relationship in path.Relationships)
				{
					var startNode = path.Nodes.First(n => n.Reference == relationship.StartNodeReference);
					var endNode = path.Nodes.First(n => n.Reference == relationship.EndNodeReference);

					var startName = startNode.Data.FirstName;
					var endName = endNode.Data.FirstName;

					var relationshipTypeKey = @relationship.TypeKey.Replace("_", " ");
		  
					<li data-start-id="@startNode.Reference.Id" data-end-id="@endNode.Reference.Id" data-relationship-id="@relationship.Reference.Id">
						@startName <label class="relationship">@relationshipTypeKey</label> @endName
					</li>
				}
			</ol>
		}
	</div>
	}
</div>